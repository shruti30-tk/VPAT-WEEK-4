Title:- Advanced Exploitation Lab – Multi-Stage Exploitation, Custom PoC & Binary Analysis

### 1. Objective

The objective of this lab is to understand advanced exploitation techniques by:
• Performing real-world exploitation using Metasploit.
• Simulating exploit chaining.
• Understanding custom PoC modification concepts.
• Analyzing binaries using Ghidra.
• Documenting findings in a professional security report.

### 2. Tools Used

• Metasploit Framework
• Kali Linux
• Python
• Ghidra
• Vulnerable VM (Metasploitable / VulnHub VM)

### 3. Lab Environment
 
Attacker Kali: Linux
Network : NAT
Attacker IP: 192.168.187.140
Target IP: 192.168.187.136

### Phase 1: Reconnaissance

• Verified target connectivity using ping.
• Identified open services.
• Confirmed vulnerable FTP service (vsFTPd 2.3.4).


### Phase 2: Exploitation Using Metasploit

Exploit Used

• exploit/unix/ftp/vsftpd_234_backdoor

Commands Executed

• use exploit/unix/ftp/vsftpd_234_backdoor
• set RHOSTS 192.168.187.136
• run
 

Result

• Backdoor service spawned.
• Root shell obtained.
• Successful remote command execution.

Exploit Log Table

| Exploit ID | Description      | Target IP       | Status  | Payload       |
| ---------- | ---------------- | --------------- | ------- | ------------- |
| 001        | FTP Backdoor RCE | 192.168.187.136 | Success | Command Shell |


Shell Verification

• whoami
• root


### Phase 3: Exploit Chaining

A real-world attack often involves chaining vulnerabilities:
1. Initial access (FTP backdoor)
2. Privilege escalation
3. Persistence
4. Lateral movement

### Phase 4: Custom PoC

A Python Proof-of-Concept from Exploit-DB can be modified by adjusting buffer size, return address offsets, or payload encoding. This helps attackers bypass basic protections and adapt exploits for different environments. Customizing PoCs enhances exploit reliability and demonstrates deeper understanding of vulnerability exploitation.
  

### Phase 5: ASLR / ROP Bypass

Return Oriented Programming (ROP) bypasses ASLR by chaining existing executable code snippets called gadgets. Instead of injecting shellcode, attackers reuse trusted memory regions, allowing execution flow manipulation even when memory randomization defenses are enabled.


### Phase 6: Binary Analysis Using Ghidra

Binary Analyzed

• /bin/ls

### 4. Ghidra Findings

• Architecture: x86-64.
• Format: ELF.
• Compiler: GCC.
• Functions identified: 245.
• Symbols identified: 278.
• Dynamic linking detected.
• Binary successfully imported and analyzed.
• Confirms reverse-engineering capability.


### 5. Findings Summary

• Insecure FTP service allowed unauthenticated RCE.
• Misconfigured services expose root access.
• Lack of defensive controls enables full compromise.

### 6.Remediation
  
• Disable vulnerable services.
• Patch outdated software.
• Enable firewall and IDS.
• Implement WAF and monitoring.
• Enforce least privilege.

### 7. Conclusion

This lab successfully demonstrates advanced exploitation concepts including exploitation, shell access, exploit chaining theory, PoC modification, ASLR bypass concepts, and binary analysis using Ghidra. The attack workflow reflects real-world penetration testing methodology.


